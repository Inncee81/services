// Tests the 'Socket IO' API loader

exports.sockets = [
    {
        event: 'process-something',
        onEvent: ({socket, message}, callback) => {
            callback(null, 'data');
        },
        middleware: [
            ({socket, socketHandler, message}, next) => {
                next();
            }
        ]
    },
    {
        event: 'send-email',
        onEvent: ({socket, message}, callback) => {
            callback(null, 'Received!');
        },
        middleware: [
            ({socket, socketHandler, message}, next) => {
                if (!message) {
                    next({message: 'No email provided!'});
                } else if (~message.address.indexOf('spam')) {
                    next({message: 'Blocked!'});
                } else {
                    next();
                }
            }
        ]
    },
    {
        event: 'connected',
        onEvent: ({socket}) => {
            socket.emit('custom-package-event', 'Hello from socket-api-package1!');
        }
    }
]
